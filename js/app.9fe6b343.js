(function(){var t={8201:function(t,s,e){"use strict";e(3316);var i=e(4639),n=(e(9031),e(6790)),a=(e(4399),e(5947)),r=(e(8984),e(797)),o=(e(2986),e(2628)),l=(e(319),e(9245)),u=(e(2443),e(9864)),c=(e(7322),e(6631)),d=(e(5825),e(9858)),h=(e(9495),e(32)),p=(e(3816),e(3946)),f=e(6369),m=function(){var t=this,s=t._self._c;return s("div",{attrs:{id:"app"}},[s("meta",{attrs:{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"}}),s("router-view")],1)},v=[],g=function(){var t=this,s=t._self._c;return s("div",[s("van-nav-bar",{attrs:{title:t.titles}}),s("van-tabbar",{attrs:{route:""}},[s("van-tabbar-item",{attrs:{to:"/layout/home",icon:"home-o"}},[t._v("首页")]),s("van-tabbar-item",{attrs:{to:"/layout/search",icon:"search"}},[t._v("搜索")])],1),s("div",{staticClass:"main"},[s("router-view")],1)],1)},y=[],_={data(){return{active:0,titles:this.$route.meta.titles}},watch:{$route(){this.titles=this.$route.meta.titles}}},w=_,L=e(1001),b=(0,L.Z)(w,g,y,!1,null,null,null),Z=b.exports,C={name:"App",components:{layout:Z}},S=C,x=(0,L.Z)(S,m,v,!1,null,null,null),k=x.exports,P=e(2631),$=function(){var t=this,s=t._self._c;return s("div",[s("p",{staticClass:"title"},[t._v("推荐歌单")]),s("van-row",{attrs:{gutter:"8"}},t._l(t.reList,(function(e){return s("van-col",{key:e.id,attrs:{span:"8"}},[s("van-image",{attrs:{width:"100%",height:"3rem",fit:"cover",src:e.picUrl}}),s("p",{staticClass:"song_name"},[t._v(t._s(e.name))])],1)})),1),s("p",{staticClass:"title"},[t._v("最新音乐")]),t._l(t.songList,(function(t){return s("SongItem",{key:t.id,attrs:{name:t.name,author:t.song.artists[0].name,id:t.id}})}))],2)},I=[],O=e(70);O.ZP.defaults.baseURL="http://localhost:3000";var E=O.ZP;const F=t=>E({url:"/personalized",params:t}),T=t=>E({url:"/personalized/newsong",params:t}),z=()=>E({url:"/search/hot"}),j=t=>E({url:"/cloudsearch",params:t}),q=t=>E({url:`/song/detail?ids=${t}`,method:"GET"}),A=t=>E({url:`/lyric?id=${t}`,method:"GET"}),U=F,D=T,M=z,N=j,G=q,R=A;var V=function(){var t=this,s=t._self._c;return s("van-cell",{attrs:{center:"",title:t.name,label:t.author+" - "+t.name},scopedSlots:t._u([{key:"right-icon",fn:function(){return[s("van-icon",{attrs:{name:"play-circle-o",size:"0.6rem"},on:{click:function(s){return t.playFn()}}})]},proxy:!0}])})},H=[],W=(e(7658),{props:{name:String,author:String,id:Number},methods:{playFn(){this.$router.push({path:"/play",query:{id:this.id}})}}}),B=W,J=(0,L.Z)(B,V,H,!1,null,"e6dccb82",null),K=J.exports,Q={components:{SongItem:K},data(){return{reList:[],songList:[]}},async created(){const t=await U({limit:6});console.log(t),this.reList=t.data.result;const s=await D({limit:20});console.log(s),this.songList=s.data.result}},X=Q,Y=(0,L.Z)(X,$,I,!1,null,"5cadbe14",null),tt=Y.exports,st=function(){var t=this,s=t._self._c;return s("div",{staticClass:"play"},[s("div",{staticClass:"song-bg",style:`background-image: url(${t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0);`}),s("div",{staticClass:"header"},[s("van-icon",{staticClass:"left-incon",attrs:{name:"arrow-left",size:"20"},on:{click:function(s){return t.$router.back()}}})],1),s("div",{staticClass:"song-wrapper"},[s("div",{staticClass:"song-turn ani",style:"animation-play-state:"+(t.playState?"running":"paused")},[s("div",{staticClass:"song-img"},[s("img",{staticStyle:{width:"100%"},attrs:{src:`${t.songInfo&&t.songInfo.al&&t.songInfo.al.picUrl}?imageView&thumbnail=360y360&quality=75&tostatic=0`,alt:""}})])]),s("div",{staticClass:"start-box",on:{click:t.audioStart}},[s("span",{directives:[{name:"show",rawName:"v-show",value:!t.playState,expression:"!playState"}],staticClass:"song-start"})]),s("div",{staticClass:"song-msg"},[s("h2",{staticClass:"m-song-h2"},[s("span",{staticClass:"m-song-sname"},[t._v(t._s(t.songInfo.name)+"-"+t._s(t.songInfo&&t.songInfo.ar&&t.songInfo.ar[0].name))])]),s("div",{staticClass:"lrcContent"},[s("p",{staticClass:"lrc"},[t._v(t._s(t.curLyric))])])]),s("div",{staticClass:"needle",style:`transform: rotate(${t.needleDeg});`})]),s("audio",{ref:"audio",attrs:{preload:"true",src:`https://music.163.com/song/media/outer/url?id=${t.id}.mp3`}})])},et=[],it={components:{[d.Z.name]:d.Z},name:"play",data(){return{playState:!1,id:this.$route.query.id,songInfo:{},lyric:{},curLyric:"",lastLy:""}},computed:{needleDeg(){return this.playState?"-7deg":"-38deg"}},methods:{async getSong(){const t=await G(this.id);this.songInfo=t.data.songs[0];const s=await R(this.id),e=s.data.lrc.lyric;this.lyric=this._formatLyr(e),this.curLyric=this.lyric[0]},_formatLyr(t){let s=/\[.+?\]/g,e=t.match(s);console.log(e);let i=t.split(/\[.+?\]/).slice(1);console.log(i);let n={};return e.forEach(((t,s)=>{let e=60*t.split(":")[0].split("")[2],a="0"===t.split(":")[1].split(".")[0].split("")[0]?t.split(":")[1].split(".")[0].split("")[1]:t.split(":")[1].split(".")[0];n[e+Number(a)]=i[s]})),console.log(n),n},audioStart(){this.playState?this.$refs.audio.pause():this.$refs.audio.play(),this.playState=!this.playState},showLyric(){this.$refs.audio.addEventListener("timeupdate",(()=>{let t=Math.floor(this.$refs.audio.currentTime);this.lyric[t]?(this.curLyric=this.lyric[t],this.lastLy=this.curLyric):this.curLyric=this.lastLy}))}},mounted(){this.getSong(),this.showLyric(),console.log(this.$route.query.id)}},nt=it,at=(0,L.Z)(nt,st,et,!1,null,"4f6ac304",null),rt=at.exports,ot=function(){var t=this,s=t._self._c;return s("div",[s("van-search",{attrs:{shape:"round",placeholder:"请输入搜索关键词"},on:{input:t.inputFn},model:{value:t.value,callback:function(s){t.value=s},expression:"value"}}),0===t.resultList.length?s("div",{staticClass:"search_wrap"},[s("p",{staticClass:"hot_title"},[t._v("热门搜索")]),s("div",{staticClass:"hot_name_wrap"},t._l(t.hotArr,(function(e,i){return s("span",{key:i,staticClass:"hot_item",on:{click:function(s){return t.fn(e.first)}}},[t._v(t._s(e.first))])})),0)]):t._e(),s("div",{staticClass:"search_wrap"},[s("p",{staticClass:"hot_title"},[t._v("最佳匹配")]),s("van-list",{attrs:{finished:t.finished,"finished-text":"暂时没有更多"},on:{load:t.onLoad},model:{value:t.loading,callback:function(s){t.loading=s},expression:"loading"}},t._l(t.resultList,(function(t){return s("SongItem",{key:t.id,attrs:{name:t.name,author:t.ar[0].name,id:t.id}})})),1)],1)],1)},lt=[],ut={components:{SongItem:K},data(){return{value:"",hotArr:[],resultList:[],loading:!1,finished:!0,page:1}},async created(){const t=await M();console.log(t),this.hotArr=t.data.result.hots},methods:{async getListFn(){return await N({keywords:this.value,limit:20,offset:20*(this.page-1)})},async fn(t){this.page=1,this.finished=!1,this.value=t;const s=await this.getListFn();console.log(s),this.resultList=s.data.result.songs,this.loading=!1},async inputFn(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout((async()=>{if(this.page=1,this.finished=!1,0===this.value.length)return void(this.resultList=[]);const t=await this.getListFn();console.log(t),void 0!==t.data.result.songs?(this.resultList=t.data.result.songs,this.loading=!1):this.resultList=[]}),900)},async onLoad(){this.page++;const t=await this.getListFn();if(void 0===t.data.result.songs)return this.finished=!0,void(this.loading=!1);this.resultList=[...this.resultList,...t.data.result.songs],this.loading=!1}}},ct=ut,dt=(0,L.Z)(ct,ot,lt,!1,null,null,null),ht=dt.exports;f.ZP.use(P.Z);const pt=[{path:"/",redirect:"/layout"},{path:"/layout",component:Z,redirect:"/layout/home",children:[{path:"home",component:tt,meta:{titles:"首页"}},{path:"search",component:ht,meta:{titles:"搜索"}},{path:"/play",component:rt}]}];var ft=new P.Z({routes:pt});e(1305);async function mt(){await U({limit:6})}f.ZP.use(p.Z),f.ZP.use(h.Z),f.ZP.use(d.Z),f.ZP.use(c.Z),f.ZP.use(u.Z),f.ZP.use(l.Z),f.ZP.use(o.Z),f.ZP.use(r.Z),f.ZP.use(a.Z),f.ZP.use(n.Z),f.ZP.use(i.Z),mt(),f.ZP.config.productionTip=!1,new f.ZP({router:ft,render:t=>t(k)}).$mount("#app")},1305:function(){(function(t,s){var e=s.documentElement,i=t.devicePixelRatio||1;function n(){s.body?s.body.style.fontSize=12*i+"px":s.addEventListener("DOMContentLoaded",n)}function a(){var t=e.clientWidth/10;e.style.fontSize=t+"px"}if(n(),a(),t.addEventListener("resize",a),t.addEventListener("pageshow",(function(t){t.persisted&&a()})),i>=2){var r=s.createElement("body"),o=s.createElement("div");o.style.border=".5px solid transparent",r.appendChild(o),e.appendChild(r),1===o.offsetHeight&&e.classList.add("hairlines"),e.removeChild(r)}})(window,document)}},s={};function e(i){var n=s[i];if(void 0!==n)return n.exports;var a=s[i]={exports:{}};return t[i](a,a.exports,e),a.exports}e.m=t,function(){var t=[];e.O=function(s,i,n,a){if(!i){var r=1/0;for(c=0;c<t.length;c++){i=t[c][0],n=t[c][1],a=t[c][2];for(var o=!0,l=0;l<i.length;l++)(!1&a||r>=a)&&Object.keys(e.O).every((function(t){return e.O[t](i[l])}))?i.splice(l--,1):(o=!1,a<r&&(r=a));if(o){t.splice(c--,1);var u=n();void 0!==u&&(s=u)}}return s}a=a||0;for(var c=t.length;c>0&&t[c-1][2]>a;c--)t[c]=t[c-1];t[c]=[i,n,a]}}(),function(){e.n=function(t){var s=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(s,{a:s}),s}}(),function(){e.d=function(t,s){for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})}}(),function(){e.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){e.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)}}(),function(){var t={143:0};e.O.j=function(s){return 0===t[s]};var s=function(s,i){var n,a,r=i[0],o=i[1],l=i[2],u=0;if(r.some((function(s){return 0!==t[s]}))){for(n in o)e.o(o,n)&&(e.m[n]=o[n]);if(l)var c=l(e)}for(s&&s(i);u<r.length;u++)a=r[u],e.o(t,a)&&t[a]&&t[a][0](),t[a]=0;return e.O(c)},i=self["webpackChunkvue_music"]=self["webpackChunkvue_music"]||[];i.forEach(s.bind(null,0)),i.push=s.bind(null,i.push.bind(i))}();var i=e.O(void 0,[998],(function(){return e(8201)}));i=e.O(i)})();
//# sourceMappingURL=app.9fe6b343.js.map